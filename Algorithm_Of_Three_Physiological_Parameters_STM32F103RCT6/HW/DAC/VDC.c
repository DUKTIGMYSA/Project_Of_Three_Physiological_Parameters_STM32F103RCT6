/*********************************************************************************************************
* 模块名称：VDC.c
* 摘    要：VDC模块
* 当前版本：1.0.0
* 作    者：SZLY(COPYRIGHT 2018 - 2020 SZLY. All rights reserved.)
* 完成日期：2020年01月01日
* 内    容：
* 注    意：                                                                  
**********************************************************************************************************
* 取代版本：
* 作    者：
* 完成日期：
* 修改内容：
* 修改文件：
*********************************************************************************************************/
/*********************************************************************************************************
*                                              包含头文件
*********************************************************************************************************/
#include "VDC.h"
#include "DataType.h"

/*********************************************************************************************************
*                                              宏定义
*********************************************************************************************************/

/*********************************************************************************************************
*                                              枚举结构体定义
*********************************************************************************************************/

/*********************************************************************************************************
*                                              内部变量
*********************************************************************************************************/

static u32 VREFmax = 4095;
static u32 VREFmin  = 0;
static u16 con_digital = 0;           //电压值转换后的数字值
/*********************************************************************************************************
*                                              内部函数声明
*********************************************************************************************************/

static void s_arrVDC (u16 volt);		//电压转换数字值

/*********************************************************************************************************
*                                              内部函数实现
*********************************************************************************************************/
/*********************************************************************************************************
* 函数名称：VDC
* 函数功能：将电压值转换为数字值
* 输入参数：volt
* 输出参数：void
* 返 回 值：digital
* 创建日期：2018年01月01日
* 注    意：输入的电压值单位为mV
*********************************************************************************************************/
static void s_arrVDC (u16 volt)
{
  u16 temp_digital;
	temp_digital = volt * 10 / 8;                               //电压值转换为数字值范围
 
  if(VREFmin < temp_digital && temp_digital < VREFmax)     //判断是否超出数字值范围
  {
    con_digital = temp_digital;
  }    
  else                                              //若电压超出数字值范围
  {
    con_digital = 0;                                //数字值改为0
  }
}

/*********************************************************************************************************
*                                              API函数实现
*********************************************************************************************************/
/*********************************************************************************************************
* 函数名称：InitVDC
* 函数功能：初始化VDC模块 
* 输入参数：void
* 输出参数：void
* 返 回 值：void
* 创建日期：2018年01月01日
* 注    意：
*********************************************************************************************************/
void  InitVDC(void)
{
  
}

/*********************************************************************************************************
* 函数名称：GetDigitalDataAddr
* 函数功能：获取当前的电压数值转换后的数字值
* 输入参数：void
* 输出参数：void
* 返 回 值：数字值的地址
* 创建日期：2018年01月01日
* 注    意：通过该函数可以更改引脚的电压值
*********************************************************************************************************/
u16* GetDigitalDataAddr(void)
{
   return(&con_digital);
}
/*********************************************************************************************************
* 函数名称：SetDigitalDataAddr
* 函数功能：设置当前的电压数值转换后的数字值
* 输入参数：void
* 输出参数：void
* 返 回 值：数字值的地址
* 创建日期：2018年01月01日
* 注    意：通过该函数可以更改引脚的电压值
*********************************************************************************************************/
u16 SetDigitalDataAddr(u16 volt)
{
  s_arrVDC(volt);
  return(con_digital);
}

