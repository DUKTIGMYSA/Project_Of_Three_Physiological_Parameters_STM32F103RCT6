/*********************************************************************************************************
* 模块名称：Wave.c
* 摘    要：Wave模块
* 当前版本：1.0.0
* 作    者：SZLY(COPYRIGHT 2018 - 2020 SZLY. All rights reserved.)
* 完成日期：2020年01月01日
* 内    容：
* 注    意：                                                                  
**********************************************************************************************************
* 取代版本：
* 作    者：
* 完成日期：
* 修改内容：
* 修改文件：
*********************************************************************************************************/
/*********************************************************************************************************
*                                              包含头文件
*********************************************************************************************************/
#include "TempRext.h"


/*********************************************************************************************************
*                                              宏定义
*********************************************************************************************************/

/*********************************************************************************************************
*                                              枚举结构体定义
*********************************************************************************************************/

/*********************************************************************************************************
*                                              内部变量
*********************************************************************************************************/
static double arrRext[502] =           // 体温探头阻值数组，阻值是从大到小排列，数组为查询相对应的温度做准备
{
  7355.0,
  7317.5,
  7280.3,
  7243.3,
  7206.4,
  7169.8,
  7133.4,
  7097.2,
  7061.2,
  7025.5,
  6989.9,
  6954.5,
  6919.3,
  6884.3,
  6849.6,
  6815.0,
  6780.6,
  6746.4,
  6712.4,
  6678.6,
  6645.0,
  6611.6,
  6578.4,
  6545.3,
  6512.5,
  6479.8,
  6447.3,
  6415.0,
  6382.9,
  6350.9,
  6312.9,
  6287.6,
  6256.2,
  6224.9,
  6193.9,
  6163.0,
  6132.3,
  6101.8,
  6071.4,
  6041.2,
  6011.2,
  5981.3,
  5951.6,
  5922.1,
  5892.8,
  5863.6,
  5834.5,
  5805.7,
  5776.9,
  5748.4,
  5720.0,
  5691.8,
  5663.7,
  5635.8,
  5608.0,
  5580.4,
  5552.9,
  5525.6,
  5498.5,
  5471.5,
  5444.6,
  5417.9,
  5391.3,
  5364.9,
  5338.7,
  5312.5,
  5286.6,
  5260.7,
  5235.0,
  5209.5,
  5184.1,
  5158.8,
  5133.7,
  5108.7,
  5083.8,
  5059.1,
  5034.5,
  5010.0,
  4985.7,
  4961.5,
  4937.5,
  4913.6,
  4889.8,
  4866.1,
  4842.6,
  4819.2,
  4795.9,
  4772.8,
  4749.7,
  4726.8,
  4704.1,
  4681.4,
  4658.9,
  4636.5,
  4614.2,
  4592.0,
  4570.0,
  4548.1,
  4526.3,
  4504.6,
  4483.0,
  4461.5,
  4440.2,
  4418.9,
  4397.8,
  4376.8,
  4355.9,
  4335.1,
  4314.4,
  4293.9,
  4273.4,
  4253.1,
  4232.8,
  4212.7,
  4192.7,
  4172.8,
  4153.0,
  4133.3,
  4113.7,
  4094.2,
  4074.8,
  4055.5,
  4036.4,
  4017.3,
  3998.3,
  3979.5,
  3960.7,
  3942.0,
  3923.5,
  3905.0,
  3886.6,
  3868.3,
  3850.2,
  3832.1,
  3814.1,
  3796.2,
  3778.4,
  3760.7,
  3743.1,
  3725.6,
  3708.2,
  3690.9,
  3673.6,
  3656.5,
  3639.4,
  3622.5,
  3605.6,
  3588.8,
  3572.1,
  3555.5,
  3539.0,
  3522.6,
  3506.2,
  3490.0,
  3473.8,
  3457.7,
  3441.7,
  3425.8,
  3409.9,
  3394.2,
  3378.5,
  3362.9,
  3347.4,
  3332.0,
  3316.6,
  3301.3,
  3286.2,
  3271.0,
  3256.0,
  3241.1,
  3226.2,
  3211.4,
  3196.7,
  3182.0,
  3167.5,
  3153.0,
  3138.5,
  3124.2,
  3109.9,
  3095.7,
  3081.6,
  3067.6,
  3053.6,
  3039.7,
  3025.9,
  3012.1,
  2998.4,
  2984.8,
  2971.3,
  2957.8,
  2944.4,
  2931.0,
  2917.8,
  2904.5,
  2891.4,
  2878.3,
  2865.3,
  2852.4,
  2839.5,
  2826.7,
  2814.0,
  2801.3,
  2788.7,
  2776.2,
  2763.7,
  2751.3,
  2739.0,
  2726.7,
  2714.5,
  2702.3,
  2690.2,
  2678.2,
  2666.2,
  2654.3,
  2642.5,
  2630.7,
  2618.9,
  2607.3,
  2595.7,
  2584.1,
  2572.6,
  2561.1,
  2549.8,
  2538.4,
  2527.2,
  2515.9,
  2504.8,
  2493.7,
  2483.6,
  2471.6,
  2460.7,
  2449.8,
  2439.0,
  2428.2,
  2417.5,
  2406.8,
  2396.2,
  2385.6,
  2375.1,
  2364.7,
  2354.3,
  2343.9,
  2333.6,
  2323.4,
  2313.2,
  2303.0,
  2292.9,
  2282.9,
  2272.9,
  2262.9,
  2253.0,
  2243.1,
  2233.3,
  2223.6,
  2213.9,
  2204.2,
  2194.5,
  2185.0,
  2175.5,
  2166.0,
  2156.6,
  2147.2,
  2137.9,
  2128.6,
  2119.4,
  2110.2,
  2101.0,
  2091.9,
  2082.9,
  2073.8,
  2064.9,
  2055.9,
  2047.0,
  2038.2,
  2029.4,
  2020.6,
  2011.9,
  2003.3,
  1994.6,
  1986.0,
  1977.5,
  1969.0,
  1960.5,
  1952.1,
  1943.7,
  1935.4,
  1927.1,
  1918.8,
  1910.6,
  1902.4,
  1894.3,
  1886.2,
  1878.1,
  1870.1,
  1862.1,
  1854.2,
  1846.3,
  1838.4,
  1830.6,
  1822.8,
  1815.0,
  1807.3,
  1799.6,
  1791.9,
  1784.3,
  1776.7,
  1769.2,
  1761.7,
  1754.2,
  1746.8,
  1739.4,
  1732.0,
  1724.7,
  1717.4,
  1710.1,
  1702.9,
  1695.7,
  1688.6,
  1681.5,
  1674.4,
  1667.3,
  1660.3,
  1653.3,
  1646.4,
  1639.5,
  1632.6,
  1625.8,
  1619.0,
  1612.2,
  1605.4,
  1598.7,
  1592.0,
  1585.4,
  1578.8,
  1572.2,
  1565.6,
  1559.1,
  1552.6,
  1546.2,
  1539.7,
  1533.3,
  1527.0,
  1520.6,
  1514.3,
  1508.0,
  1501.8,
  1495.6,
  1489.4,
  1483.2,
  1477.1,
  1471.0,
  1464.9,
  1458.9,
  1452.9,
  1446.9,
  1440.9,
  1435.0,
  1429.1,
  1423.2,
  1417.4,
  1411.6,
  1405.8,
  1400.0,
  1394.3,
  1388.6,
  1382.9,
  1377.2,
  1371.6,
  1366.0,
  1360.4,
  1354.9,
  1349.4,
  1343.9,
  1338.4,
  1333.0,
  1327.6,
  1322.2,
  1316.8,
  1311.4,
  1306.1,
  1300.8,
  1295.6,
  1290.3,
  1285.1,
  1279.9,
  1274.7,
  1269.6,
  1264.5,
  1259.4,
  1254.3,
  1249.2,
  1244.2,
  1239.2,
  1234.2,
  1229.3,
  1224.3,
  1219.4,
  1214.5,
  1209.7,
  1204.8,
  1200.0,
  1195.2,
  1190.4,
  1185.6,
  1180.9,
  1176.1,
  1171.4,
  1166.8,
  1162.1,
  1157.4,
  1152.8,
  1148.2,
  1143.6,
  1139.1,
  1134.6,
  1130.0,
  1125.5,
  1121.1,
  1116.6,
  1112.2,
  1107.8,
  1103.4,
  1099.0,
  1094.6,
  1091.3,
  1086.0,
  1081.7,
  1077.4,
  1073.2,
  1068.9,
  1064.7,
  1060.5,
  1056.3,
  1052.2,
  1048.0,
  1043.9,
  1039.8,
  1035.7,
  1031.6,
  1027.6,
  1023.5,
  1019.5,
  1015.5,
  1011.6,
  1007.6,
  1003.7,
  999.7,
  995.8,
  991.9,
  988.1,
  984.2,
  980.4,
  976.5,
  972.7,
  968.9,
  965.2,
  961.4,
  957.7,
  954.0,
  950.3,
  946.6,
  942.9,
  939.3,
  935.6,
  932.0,
  928.4,
  924.8,
  921.2,
  917.7,
  914.1,
  910.6,
  907.1,
  903.6,
  900.1,
  896.6,
  893.2,
  889.8,
  886.3,
  882.9,
  879.5,
  876.2,
  872.8,
  869.5,
  866.1,
  862.8,
  859.5,
  856.2,
  853.0,
  849.7,
  846.5,
  843.2,
  840.0,
  836.8,
  833.6,
  830.5,
  827.3,
  824.1,
  821.0,
  817.9,
  814.8,
  811.3,
  807.0
};
/*********************************************************************************************************
*                                              内部函数声明
*********************************************************************************************************/

/*********************************************************************************************************
*                                              内部函数实现
*********************************************************************************************************/

/*********************************************************************************************************
*                                              API函数实现
*********************************************************************************************************/
/*********************************************************************************************************
* 函数名称：RextTurnToTemp
* 函数功能：根据阻值得到相对应的温度 
* 输入参数：void
* 输出参数：void
* 返 回 值：void
* 创建日期：2018年01月01日
* 注    意：
*********************************************************************************************************/
double RextTurnToTemp(double Rextnum0)    // 由体温探头阻值得到相对应的体温值
{
  int i;                                  // i的值为体温探头阻值数组对应的下标，i的值除以10即为体温数据
  double tempnum0 = 0.0;                  // 体温数据初始化
  
  //注：体温探头阻值数组存放的阻值是从大到小排列
  for(i = 0;i<=(sizeof(arrRext)/sizeof(arrRext[0]) - 1);i++)      // 遍历体温探头阻值数组
  {
    if(Rextnum0 < arrRext[i] && Rextnum0 > arrRext[i+1])         // 确定计算的阻值位于相邻两个阻值之间
    {
      if((arrRext[i] - Rextnum0) >= (Rextnum0 - arrRext[i+1]))   // 体温阻值离相邻两个阻值的最小值比较近或阻值离相邻两个阻值的距离相等
      {
        tempnum0 = (i+2)/10.0;                                   // i+2为当前体温阻值离相邻两个阻值的最小值的位置（不是数组下标），该位置值除以10即为体温数据
        break;
      }
      else                                                       // 体温阻值离相邻两个阻值的最大值比较近
      {
        tempnum0 = (i+1)/10.0;                                   // i+1为当前体温阻值离相邻两个阻值的最大值的位置（不是数组下标），该位置值除以10即为体温数据
        break;
      }
    }
    else if(Rextnum0 == arrRext[i])                              // 体温阻值与相邻两个阻值的最大值相等
    {
      tempnum0 = (i+1)/10.0;                                     // i+1为当前体温阻值离相邻两个阻值的最大值的位置也是此刻体温阻值所在的位置（不是数组下标），该位置值除以10即为体温数据
      break;
    }
    else if(Rextnum0 == arrRext[i+1])                            // 体温阻值与相邻两个阻值的最小值相等
    {
      tempnum0 = (i+2)/10.0;                                     // i+2为当前体温阻值离相邻两个阻值的最小值的位置（不是数组下标），该位置值除以10即为体温数据
      break;
    }
  }

  return tempnum0;                                               // 返回体温数据
}
